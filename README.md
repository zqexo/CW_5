# course_work_5_DB
# HH Vacancies Project

Этот проект предназначен для получения данных о работодателях и вакансиях с сайта hh.ru, их сохранения в базу данных PostgreSQL и предоставления различных методов для работы с этими данными.

## Оглавление

- [Описание](#описание)
- [Требования](#требования)
- [Установка](#установка)
- [Использование](#использование)
- [Методы DBManager](#методы-dbmanager)
- [Тестирование](#тестирование)

## Описание

Проект включает в себя следующие основные функции:

1. Получение данных о работодателях и вакансиях с сайта hh.ru с использованием публичного API.
2. Сохранение полученных данных в файлы и базу данных PostgreSQL.
3. Фильтрация, сортировка и поиск вакансий по различным критериям.
4. Предоставление различных методов для работы с данными в базе данных через класс `DBManager`.

## Требования

- Python 3.10+
- PostgreSQL
- Poetry

## Установка

1. **Клонирование репозитория**

    ```sh
    git clone https://github.com/yourusername/your-repo.git
    cd your-repo
    ```

2. **Установка Poetry**

    Следуйте инструкциям на [официальном сайте Poetry](https://python-poetry.org/docs/#installation).

    Либо используйте команду:

    ```sh
    curl -sSL https://install.python-poetry.org | python3 -
    ```

3. **Установка зависимостей**

    В корневой директории проекта выполните команду:

    ```sh
    poetry install
    ```

4. **Запуск виртуальной среды**

    ```sh
    poetry shell
    ```

5. **Настройка базы данных**

    Убедитесь, что PostgreSQL установлен и настроен. Создайте базу данных и таблицы, необходимые для работы проекта. Пример SQL-запроса для создания таблицы `vacancies`:

    ```sql
    CREATE TABLE organizations (
        id SERIAL PRIMARY KEY,
        name TEXT NOT NULL
    );

    CREATE TABLE vacancies (
        id SERIAL PRIMARY KEY,
        name TEXT,
        url TEXT,
        salary_from INTEGER,
        salary_to INTEGER,
        city TEXT,
        experience TEXT,
        organization_id INTEGER REFERENCES organizations(id)
    );
    ```

    **Пример файла конфигурации `database.ini`**:

    ```ini
    [postgresql]
    host=localhost
    database=your_database
    user=your_user
    password=your_password
    ```

## Использование

1. **Запуск основного скрипта**

    Основной скрипт для взаимодействия с пользователем находится в файле `main.py`. Запустите его для получения данных и взаимодействия с пользователем:

    ```sh
    python main.py
    ```

## Методы DBManager

Класс `DBManager` предоставляет следующие методы для работы с базой данных:

- `get_companies_and_vacancies_count()`: получает список всех компаний и количество вакансий у каждой компании.
- `get_all_vacancies()`: получает список всех вакансий с указанием названия компании, названия вакансии, зарплаты и ссылки на вакансию.
- `get_avg_salary()`: получает среднюю зарплату по вакансиям.
- `get_vacancies_with_higher_salary()`: получает список всех вакансий, у которых зарплата выше средней по всем вакансиям.
- `get_vacancies_with_keyword(keyword)`: получает список всех вакансий, в названии которых содержатся переданные в метод слова.

## Тестирование

Для запуска тестов используйте следующую команду:

```sh
pytest
